# Assumptions

| Topic              | จุดที่ไม่ชัดเจน (Ambiguity)                                                                                               | สมมติฐานที่ใช้ (Assumptions)                                                               | หมายเหตุ (Remark)                |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ | -------------------------------- |
| Authentication     | ไม่ได้ระบุรายละเอียดเกี่ยวกับการทำงานของระบบ Authentication (เช่น Login/Signup หรือการใช้ JWT) มีเพียงการ seed test users | สมมติว่าระบบไม่จำเป็นต้องทำ Authentication จริง ใช้เพียงการ seed test users สำหรับการทดสอบ |                                  |
| User Context       | ไม่ได้อธิบายวิธีการที่ Client จะส่ง User Context มายังระบบ                                                                | สมมติให้ระบบใช้ Developer Tool หรือ Header (เช่น `X-USER-ID`) เพื่อส่ง User Context        | เนื่องจากไม่ได้ทำ Authentication |
| Canceling Booking  | ไม่ชัดเจนว่าหากผู้ใช้ยกเลิกการจอง (Booking) ระบบจะคืนจำนวนตั๋วกลับไปยัง Event หรือไม่                                     | สมมติว่าหากยกเลิกการจอง ระบบจะต้องคืนจำนวนตั๋วกลับไปยัง Event                              |                                  |
| Canceling Event    | ไม่ได้บอกว่าหากเปลี่ยนสถานะ Event เป็น `cancelled` จะยังสามารถทำการจองต่อไปได้หรือไม่                                     | สมมติว่าหาก Event ถูกเปลี่ยนสถานะเป็น `cancelled` จะต้องไม่สามารถทำการจองเพิ่มเติมได้      |                                  |
| Ticket Code        | ไม่ได้ระบุรูปแบบของ Ticket Code (เช่น String, QR Code, Barcode ฯลฯ)                                                       | สมมติว่า Ticket Code จะถูกสร้างในรูปแบบ String แบบสุ่ม (unique)                            |                                  |
| Event Availability | ไม่แน่ชัดว่าระบบต้องอัปเดตข้อมูลตั๋วที่เหลือแบบ Real-time หรือเพียงอัปเดตเมื่อ Refresh หน้า                               | สมมติว่าใช้กลไก Polling API เพื่ออัปเดตจำนวนตั๋วคงเหลือแบบใกล้เคียง Real-time              | ใช้ Polling API interval         |

## About RealTime Ticket Avalible

| ทางเลือก                             | ควรใช้เมื่อไหร่                                                                                 | ข้อดี                                                                              | ข้อเสีย                                                                                                                                   |
| ------------------------------------ | ----------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| **WebSocket (ทำเซิร์ฟเวอร์เอง)**     | ต้องการควบคุมโปรโตคอล/พฤติกรรมละเอียดมาก ๆ หรือมีเคสพิเศษที่บริการสำเร็จรูปทำให้ไม่ได้          | Real-time แท้, ปรับแต่งได้สุด, ไม่ผูกกับผู้ให้บริการ                               | ซับซ้อนเรื่อง scaling (sticky session, fan-out, backpressure), ต้องทำ reconnect/auth/monitoring เอง, ถ้าตัวกลางล้ม connection หลุดทั้งฝูง |
| **Interval Polling**                 | โปรเจ็กต์เล็ก/ต้นแบบ ต้องการทำให้เสร็จเร็ว ใช้ REST เดิม ๆ โดยไม่เพิ่ม infra                    | ง่ายสุด, ไม่ต้องเปิดคอนเนกชันค้าง, คุมโหลดได้ด้วย interval                         | ไม่ real-time จริง, ถ้า 10k ผู้ใช้และ interval ถี่จะยิง request มหาศาล, เสี่ยงโหลด DB, UX อาจต้อง “tick” หลอก                             |
| **Pusher / Ably (pusher service)**   | ต้องการ real-time ที่ scale ได้ไว โดยไม่อยากดูแล WebSocket เอง                                  | Managed, รองรับหมื่น+ connections ง่าย, SDK/ฟีเจอร์ pub/sub ครบ                    | มีค่าใช้จ่ายตาม connection/message, ผูกกับผู้ให้บริการ, ต้องออกแบบช่อง/โควตาข้อความดี ๆ                                                   |
| **Firebase (Firestore/Realtime DB)** | สาย serverless, อยากได้ listener แบบ `onSnapshot` + Cloud Functions จัดการ logic/atomic updates | Real-time ง่าย, scale ดีมาก, SDK ครบ, ทำธุรกรรมพื้นฐาน/Rule ได้                    | คิดเงินตาม read/write → ต้องลดการอ่านถี่, ธุรกรรมซับซ้อนอาจต้องโยนเข้า Functions, ผูกกับ ecosystem                                        |
| **Supabase (Postgres + Realtime)**   | ต้องการพลัง Postgres (transaction, FK, constraint) + push realtime จากฐานข้อมูลโดยตรง           | ได้ SQL/transaction แน่น, มี Realtime จาก logical replication, ทำ trigger/RPC ง่าย | Throughput realtime ต้องออกแบบให้เป็น aggregate ไม่สแปม row, มีโควต้า/แผนราคา, ต้องคิดเรื่อง debounce/batch                               |



| ตัวเลือก                       | ง่าย         | Real-time                   | สเกล 10k ผู้ใช้                         | ความเสี่ยงล้ม/ซับซ้อน                         | ค่าบริการ                 |
| ------------------------------ | ------------ | --------------------------- | --------------------------------------- | --------------------------------------------- | ------------------------- |
| WebSocket เซิร์ฟเวอร์เอง       | ยาก          | ดีมาก                       | ต้องจัด cluster/load balancer เอง       | สูง (ต้องทำ reconnect, backpressure, fan-out) | ค่า infra เอง             |
| Interval Polling               | ง่าย         | กึ่งจริง (ขึ้นกับ interval) | 10k จะยิงถี่มากถ้าไม่กระจายเวลา         | ต่ำ                                           | ถูก แต่เสี่ยงโหลด DB      |
| Pusher/Ably (pusher service)   | ง่าย         | ดีมาก                       | เขารับภาระ scale ให้                    | ต่ำ                                           | คิดตาม connection/message |
| Firebase (Firestore/RTDB)      | ค่อนข้างง่าย | ดีมาก                       | scale ดี, SDK ครบ                       | ต่ำ                                           | ตาม read/write            |
| Supabase (Postgres + Realtime) | ค่อนข้างง่าย | ดีมาก                       | ดีระดับหนึ่ง (ใช้ Realtime/replication) | ต่ำ-กลาง                                      | ตามแผนราคา Supabase       |
