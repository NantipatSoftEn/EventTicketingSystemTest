<div class="mx-auto max-w-7xl">
    <!-- Header -->
    <div class="mb-6 flex items-center justify-between">
        <div>
            <h2 class="mb-2 text-2xl font-bold text-gray-900">Manage Events</h2>
            <p class="text-gray-600">
                View and manage all events in the system
            </p>
        </div>
        <a
            routerLink="/admin/create-event"
            class="rounded-md bg-blue-600 px-4 py-2 font-medium text-white transition-colors hover:bg-blue-700"
        >
            Create New Event
        </a>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading$ | async" class="py-12 text-center">
        <div
            class="inline-block h-12 w-12 animate-spin rounded-full border-b-2 border-blue-600"
        ></div>
        <p class="mt-4 text-gray-600">Loading events...</p>
    </div>
    <!-- Summary Stats -->
    <div
        *ngIf="!(isLoading$ | async) && (events$ | async)?.length! > 0"
        class="mt-8 grid grid-cols-1 gap-4 md:grid-cols-4"
    >
        <div class="rounded-lg bg-white p-4 shadow">
            <div class="text-sm text-gray-600">Total Events</div>
            <div class="text-2xl font-bold text-gray-900">
                {{ (events$ | async)?.length || 0 }}
            </div>
        </div>

        <div class="rounded-lg bg-white p-4 shadow">
            <div class="text-sm text-gray-600">Active Events</div>
            <div class="text-2xl font-bold text-green-600">
                {{ activeEventsCount$ | async }}
            </div>
        </div>

        <div class="rounded-lg bg-white p-4 shadow">
            <div class="text-sm text-gray-600">Total Revenue</div>
            <div class="text-2xl font-bold text-blue-600">
                <!-- {{ formatPrice((totalRevenue$ | async) || 0) }} -->
                Comming soon
            </div>
        </div>

        <div class="rounded-lg bg-white p-4 shadow">
            <div class="text-sm text-gray-600">Tickets Sold</div>
            <div class="text-2xl font-bold text-purple-600">
                {{ totalTicketsSold$ | async }}
            </div>
        </div>
    </div>

    <!-- No Events -->
    <div
        *ngIf="!(isLoading$ | async) && (events$ | async)?.length === 0"
        class="py-12 text-center"
    >
        <div class="mb-4 text-gray-400">
            <svg
                class="mx-auto h-16 w-16"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                ></path>
            </svg>
        </div>
        <h3 class="mb-2 text-xl font-semibold text-gray-900">
            No events found
        </h3>
        <p class="mb-4 text-gray-600">
            Get started by creating your first event.
        </p>
        <a
            routerLink="/admin/create-event"
            class="rounded-md bg-blue-600 px-6 py-2 font-medium text-white transition-colors hover:bg-blue-700"
        >
            Create Event
        </a>
    </div>

    <!-- Events Table -->
    <div
        *ngIf="!(isLoading$ | async) && (events$ | async)?.length! > 0"
        class="overflow-hidden rounded-lg bg-white shadow-md"
    >
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th
                            scope="col"
                            class="px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase"
                        >
                            Event
                        </th>
                        <th
                            scope="col"
                            class="px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase"
                        >
                            Date & Venue
                        </th>
                        <th
                            scope="col"
                            class="px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase"
                        >
                            Tickets
                        </th>
                        <th
                            scope="col"
                            class="px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase"
                        >
                            Revenue
                        </th>
                        <th
                            scope="col"
                            class="px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase"
                        >
                            Status
                        </th>
                        <th
                            scope="col"
                            class="px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase"
                        >
                            Actions
                        </th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200 bg-white">
                    <tr
                        *ngFor="
                            let event of events$ | async;
                            trackBy: trackByEventId
                        "
                        class="hover:bg-gray-50"
                    >
                        <!-- Event Info -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="h-12 w-12 flex-shrink-0">
                                    <img
                                        [src]="event.image"
                                        [alt]="event.title"
                                        class="h-12 w-12 rounded-lg object-cover"
                                    />
                                </div>
                                <div class="ml-4">
                                    <div
                                        class="max-w-xs truncate text-sm font-medium text-gray-900"
                                    >
                                        {{ event.title }}
                                    </div>
                                    <div class="text-xs text-gray-400">
                                        ID: {{ event.id }}
                                    </div>
                                </div>
                            </div>
                        </td>

                        <!-- Date & Venue -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-900">
                                {{ formatDate(event.date) }}
                            </div>
                            <div class="text-sm text-gray-500">
                                {{ event.time }}
                            </div>
                            <div
                                class="max-w-xs truncate text-xs text-gray-400"
                            >
                                {{ event.venue }}
                            </div>
                            <div
                                *ngIf="isEventPast(event.date)"
                                class="text-xs font-medium text-red-500"
                            >
                                Past Event
                            </div>
                        </td>

                        <!-- Tickets -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-900">
                                {{ event.totalTicketsSold }} /
                                {{ event.totalTickets }} sold
                            </div>
                            <div class="text-sm text-gray-500">
                                {{ event.availableTickets }} available
                            </div>
                            <div
                                [class]="
                                    'text-xs font-medium ' +
                                    getAvailabilityStatus(event).class
                                "
                            >
                                {{ getAvailabilityStatus(event).text }}
                            </div>
                            <div class="text-xs text-gray-400">
                                {{ formatPrice(event.price) }} each
                            </div>
                        </td>

                        <!-- Revenue -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm font-medium text-gray-900">
                                {{ formatPrice(event.totalRevenue) }}
                            </div>
                            <div class="text-sm text-gray-500">
                                {{ event.totalBookings }} booking(s)
                            </div>
                            <div class="text-xs text-gray-400">
                                Potential:
                                {{
                                    formatPrice(
                                        event.totalTickets * event.price
                                    )
                                }}
                            </div>
                        </td>

                        <!-- Status -->
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span
                                [class]="
                                    'rounded-full px-2 py-1 text-xs font-medium ' +
                                    getEventStatusClass(event.status)
                                "
                            >
                                {{ getStatusLabel(event.status) }}
                            </span>
                        </td>

                        <!-- Actions -->
                        <td
                            class="space-y-1 px-6 py-4 text-sm font-medium whitespace-nowrap"
                        >
                            <div class="flex flex-col space-y-1">
                                <a
                                    [routerLink]="['/events', event.id]"
                                    class="text-xs text-blue-600 hover:text-blue-900"
                                >
                                    View Details
                                </a>

                                <select
                                    [value]="event.status"
                                    (change)="
                                        updateEventStatus(
                                            event,
                                            $any($event.target).value
                                        )
                                    "
                                    class="rounded border px-2 py-1 text-xs text-gray-700 focus:ring-1 focus:ring-blue-500 focus:outline-none"
                                >
                                    <option value="active">Active</option>
                                    <option value="cancelled">Cancelled</option>
                                    <option value="completed">Completed</option>
                                </select>

                                <a
                                    routerLink="/admin/event-bookings"
                                    [queryParams]="{ eventId: event.id }"
                                    class="text-xs text-purple-600 hover:text-purple-900"
                                >
                                    View Bookings
                                </a>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
